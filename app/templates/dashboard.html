<!DOCTYPE html>
<html>
<head>
    <title>Crypto Order Book Dashboard</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #1e1e1e; color: white; }
        .container { display: flex; gap: 20px; }
        .column { flex: 1; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 8px; text-align: right; }
        .bid { background: rgba(0, 128, 0, 0.2); }
        .ask { background: rgba(128, 0, 0, 0.2); }
        .total { font-weight: bold; }
    </style>
</head>
<body>
    <h2>Order Book (BTC/USDT)</h2>
    <div class="container">
        <div class="column">
            <h3>BID</h3>
            <table id="bid-table">
                <thead><tr><th>Price</th><th>Amount</th></tr></thead>
                <tbody></tbody>
            </table>
        </div>
        <div class="column">
            <h3>ASK</h3>
            <table id="ask-table">
                <thead><tr><th>Price</th><th>Amount</th></tr></thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <script>
        async function update() {
            const res = await fetch(`/api/orderbook?symbol=BTCUSDT&min_volume_usdt=10000`);
            const data = await res.json();
            if (data.error) {
                console.log(data.error);
                return;
            }

            const bids = data.orderbook.bids;
            const asks = data.orderbook.asks;

            // Заполняем таблицы
            document.getElementById('bid-table').querySelector('tbody').innerHTML =
                bids.map(b => `<tr class="bid"><td>${b.price.toFixed(1)}</td><td>${b.amount.toFixed(2)}</td></tr>`).join('');

            document.getElementById('ask-table').querySelector('tbody').innerHTML =
                asks.map(a => `<tr class="ask"><td>${a.price.toFixed(1)}</td><td>${a.amount.toFixed(2)}</td></tr>`).join('');
        }

        setInterval(update, 2000);
        update();
    </script>
</body>
</html>